%YAML 1.1
---

# Suricata YAML Configuration

# Global settings
vars:
  address-groups:
    HOME_NET: "[192.168.0.0/16,10.0.0.0/8,172.16.0.0/12]"
    EXTERNAL_NET: "!$HOME_NET"
    HTTP_SERVERS: "$HOME_NET"
    SMTP_SERVERS: "$HOME_NET"
    SQL_SERVERS: "$HOME_NET"
    DNS_SERVERS: "$HOME_NET"
    TELNET_SERVERS: "$HOME_NET"
    AIM_SERVERS: "$EXTERNAL_NET"

  port-groups:
    HTTP_PORTS: "80"
    SHELLCODE_PORTS: "!80"
    ORACLE_PORTS: 1521
    SSH_PORTS: 22

# Rule files - load all .rules files from /etc/suricata/rules/
default-rule-path: /etc/suricata/rules
rule-files:
  - suricata.rules
  - local.rules

# Stats configuration
stats:
  enabled: yes
  interval: 8

# Logging outputs
outputs:
  - eve-log:
      enabled: yes
      filetype: regular
      filename: /var/log/suricata/eve.jsonl
      pcap-file: false
      community-id: true
      community-id-seed: 0
      types:
        - alert:
            tagged-packets: yes
        - anomaly:
            enabled: yes
        - http:
            extended: yes
        - dns
        - tls:
            extended: yes
        - files:
            force-magic: no
        - smtp
        - flow
        - stats:
            totals: yes
            threads: no

  - stats:
      enabled: yes
      filename: /var/log/suricata/stats.log
      append: yes
      totals: yes
      threads: no

  - fast:
      enabled: yes
      filename: /var/log/suricata/fast.log
      append: yes

# Packet capture settings
# Interface settings are passed via command line -i flag
af-packet:
  - interface: default
    cluster-id: 99
    cluster-type: cluster_flow
    defrag: yes

# Pattern matching
detect:
  profile: medium
  custom-values:
    toclient-groups: 3
    toserver-groups: 25
  sgh-mpm-context: auto
  inspection-recursion-limit: 3000

# App-layer detection
app-layer:
  protocols:
    http:
      enabled: yes
      libhtp:
        default-config:
          request-body-limit: 100kb
          response-body-limit: 100kb
    tls:
      enabled: yes
    dns:
      enabled: yes
    ssh:
      enabled: yes
    dnp3:
      enabled: yes
      detection-ports:
        dp: 20000
    modbus:
      enabled: yes
      detection-ports:
        dp: 502
      stream-depth: 0

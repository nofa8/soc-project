<group name="soc,api">

  <rule id="100001" level="3">
    <decoded_as>json</decoded_as>
    <field name="soc_event">login_success</field>
    <description>Successful API Login</description>
  </rule>

  <rule id="100002" level="5">
    <decoded_as>json</decoded_as>
    <field name="soc_event">login_failed</field>
    <description>Failed API Login</description>
  </rule>

  <rule id="100003" level="10" frequency="5" timeframe="60">
    <if_matched_sid>100002</if_matched_sid>
    <description>Brute Force Attack Detected</description>
  </rule>

  <rule id="100004" level="12">
    <field name="soc_event">possible_sqli</field>
    <description>SQL Injection Attempt</description>
  </rule>

  <rule id="100005" level="7">
    <field name="status_code">500</field>
    <field name="component">api</field>
    <description>API Error / Anomalous Behavior</description>
  </rule>

  <rule id="100006" level="12">
    <field name="event_type">alert</field>
    <description>Network Intrusion Detected by IDS</description>
  </rule>

</group>

<group name="soc,api,application">

  <!-- API Application Events -->

  <rule id="100002" level="3">
    <decoded_as>json</decoded_as>
    <field name="soc_event">login_success</field>
    <description>Successful API Login</description>
    <options>no_full_log</options>
    <group>api,authentication,</group>
  </rule>

  <rule id="100003" level="5">
    <decoded_as>json</decoded_as>
    <field name="soc_event">login_failed</field>
    <description>Failed API Login</description>
    <mitre>
      <id>T1110</id>
    </mitre>
    <group>api,authentication_failed,</group>
  </rule>

  <rule id="100004" level="10" frequency="5" timeframe="60">
    <if_matched_sid>100003</if_matched_sid>
    <description>Brute Force Attack Detected (Multiple Failed Logins)</description>
    <mitre>
      <id>T1110</id>
    </mitre>
    <group>api,bruteforce,</group>
  </rule>

  <rule id="100005" level="12">
    <decoded_as>json</decoded_as>
    <field name="soc_event">possible_sqli</field>
    <description>SQL Injection Attempt Detected</description>
    <mitre>
      <id>T1190</id>
    </mitre>
    <group>api,sqli,</group>
  </rule>

  <rule id="100006" level="7">
    <decoded_as>json</decoded_as>
    <field name="soc_event">http_request</field>
    <field name="status_code">500</field>
    <description>API Internal Error / Anomalous Behavior</description>
    <options>no_full_log</options>
    <group>api,anomaly,</group>
  </rule>

  <!-- Suricata: Recon / Scanning Detection -->

  <rule id="100101" level="5">
    <if_matched_group>suricata</if_matched_group>
    <field name="event_type">^alert$</field>
    <field name="alert.signature_id">1000001</field>
    <description>Suricata: ICMP Echo Request (ping)</description>
    <mitre>
      <id>T1040</id>
    </mitre>
    <group>suricata,ids,reconnaissance,network,</group>
  </rule>

  <rule id="100102" level="7">
    <if_matched_group>suricata</if_matched_group>
    <field name="event_type">^alert$</field>
    <field name="alert.signature_id">1000002</field>
    <description>Suricata: SYN scan detected (possible reconnaissance)</description>
    <mitre>
      <id>T1595</id>
    </mitre>
    <group>suricata,ids,reconnaissance,network_scan,</group>
  </rule>

  <rule id="100103" level="7">
    <if_matched_group>suricata</if_matched_group>
    <field name="event_type">^alert$</field>
    <field name="alert.signature_id">1000003</field>
    <description>Suricata: FIN scan detected (possible reconnaissance)</description>
    <mitre>
      <id>T1595</id>
    </mitre>
    <group>suricata,ids,reconnaissance,network_scan,</group>
  </rule>

  <rule id="100104" level="7">
    <if_matched_group>suricata</if_matched_group>
    <field name="event_type">^alert$</field>
    <field name="alert.signature_id">1000004</field>
    <description>Suricata: XMAS scan detected (possible reconnaissance)</description>
    <mitre>
      <id>T1595</id>
    </mitre>
    <group>suricata,ids,reconnaissance,network_scan,</group>
  </rule>

  <!-- Suricata: Suspicious HTTP User Agents -->

  <rule id="100110" level="10">
    <if_matched_group>suricata</if_matched_group>
    <field name="event_type">^alert$</field>
    <field name="alert.signature_id">1100001</field>
    <description>Suricata: Suspicious HTTP User-Agent (curl)</description>
    <mitre>
      <id>T1071</id>
    </mitre>
    <group>suricata,ids,http,abuse,</group>
  </rule>

  <rule id="100111" level="10">
    <if_matched_group>suricata</if_matched_group>
    <field name="event_type">^alert$</field>
    <field name="alert.signature_id">1100002</field>
    <description>Suricata: Suspicious HTTP User-Agent (SQLMap)</description>
    <mitre>
      <id>T1190</id>
    </mitre>
    <group>suricata,ids,http,abuse,web_attack,</group>
  </rule>

  <!-- Suricata: Brute Force / Auth Abuse -->

  <rule id="100120" level="12">
    <if_matched_group>suricata</if_matched_group>
    <field name="event_type">^alert$</field>
    <field name="alert.signature_id">1200001</field>
    <description>Suricata: SSH brute force attempts</description>
    <mitre>
      <id>T1110</id>
    </mitre>
    <group>suricata,ids,bruteforce,authentication,</group>
  </rule>

  <!-- Suricata Correlation -->

  <rule id="100130" level="14" frequency="10" timeframe="60">
    <if_matched_group>suricata</if_matched_group>
    <description>Multiple Suricata alerts (potential coordinated activity)</description>
    <mitre>
      <id>T1589</id>
    </mitre>
    <group>suricata,ids,correlation,</group>
  </rule>

  <rule id="100131" level="13" frequency="3" timeframe="120">
    <if_matched_group>suricata</if_matched_group>
    <same_srcip />
    <description>Multiple Suricata alerts from the same source IP</description>
    <mitre>
      <id>T1589</id>
    </mitre>
    <group>suricata,ids,correlation,</group>
  </rule>
</group>
<group name="soc,api,application">
  <rule id="100001" level="3">
    <decoded_as>json</decoded_as>
    <field name="soc_event">login_success</field>
    <description>Successful API Login</description>
    <options>no_full_log</options>
  </rule>

  <rule id="100002" level="5">
    <decoded_as>json</decoded_as>
    <field name="soc_event">login_failed</field>
    <description>Failed API Login</description>
    <mitre>
      <id>T1110</id>
    </mitre>
  </rule>

  <rule id="100003" level="10" frequency="5" timeframe="60">
    <if_matched_sid>100002</if_matched_sid>
    <description>Brute Force Attack Detected (Multiple Failed Logins)</description>
    <mitre>
      <id>T1110</id>
    </mitre>
  </rule>

  <rule id="100004" level="12">
    <decoded_as>json</decoded_as>
    <field name="soc_event">possible_sqli</field>
    <description>SQL Injection Attempt Detected</description>
    <mitre>
      <id>T1190</id>
    </mitre>
  </rule>

  <rule id="100005" level="7">
    <decoded_as>json</decoded_as>
    <field name="status_code">500</field>
    <field name="component">api-engine</field>
    <description>API Internal Error / Anomalous Behavior</description>
    <options>no_full_log</options>
  </rule>

  <rule id="100006" level="12">
    <if_matched_group>suricata</if_matched_group>
    <field name="event_type">alert</field>
    <description>Network Intrusion Detected by IDS (Suricata)</description>
    <mitre>
      <id>T1046</id>
    </mitre>
  </rule>
</group>
